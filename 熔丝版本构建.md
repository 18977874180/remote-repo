## 一、替换签名包
**将传音返回来的签名包替换到代码基线，重新组NON-HLOS.bin镜像**
* 使用对比工具，对齐目录；将vendor和nonhlos目录下的东西全部复制到代码基线对应目录下

![image-20250712172436707](C:\Users\hongjian.liang\AppData\Roaming\Typora\typora-user-images\image-20250712172436707.png)
* 然后切换到目录`project/nonhlos/Divar.LA.3.0.1/common/build`下运行如下命令组包，使用签名的组件重新构建刷机镜像

>代码服务器使可以使用   
``` bash
172.21.5.210
hongjian.liang
tinno123
# 切到 sec-t1102/nonhlos/Divar.LA.3.0.1/common/build/ 目录下
```

``` bash
python build.py --imf 2>&1|tee generate_non_hlos.log
# generate_non_hlos.log 存log的文件，名字可以任意更改
```
运行成功后，NON-HLOS.bin镜像会重新生成在`project/nonhlos/Divar.LA.3.0.1/common/build/ufs/bin/asic/NON-HLOS.bin`目录下，即完成这一步骤

## 二、替换刷机包，组成熔丝版本
**将签名包里面的镜像替换到刷机包中**
<span style="color:red">需要替换的镜像列表：</span>

* smplap64.mbn 
* smplap32.mbn 
* prog_firehose_lite.elf
* prog_firehose_ddr.elf
* xbl_config.elf
* xbl.elf
* uefi_sec.mbn
* tz.mbn
* storsec.mbn
* sec.elf      //  在去签名包` ~\t1102-sign\sectools\fuseblower_output\v2`路径下面
* rpm.mbn
* qupv3fw.elf
* keymint.mbn
* imagefv.elf
* hyp.mbn
* devcfg.mbn
* abl.elf
* NON-HLOS.bin   // 使用第一步重新构建出来的NON-HLOS.bin
> 不想对照，可以把签名包里面所有的的签名镜像都覆盖到刷机包里，MPSS.HA.1.2路径下面只需要替换`签名包\nonhlos\MPSS.HA.1.2\modem_proc\build`这个路径的镜像
> vendor目录下只需要覆盖 `签名包\vendor\out`这个目录下的东西

## 三、修改描述文件，刷入sec.elf
完成以上步骤后，在替换镜像后的刷机包里面找到`rawprogram4.xml`文件，在里面搜索`secdata`，找到下面这行，将`filename=""`改成`filename="sec.elf"`，然后保存
``` xml
  <program SECTOR_SIZE_IN_BYTES="4096" file_sector_offset="0" filename="sec.elf" label="secdata" num_partition_sectors="7" partofsingleimage="false" physical_partition_number="4" readbackverify="false" size_in_KB="28.0" sparse="false" start_byte_hex="0x58764000" start_sector="362340"/>
```
<span style="color:red">**完成上面所有步骤后就可以刷机验证了！切记要使用熔丝的板子**</span>