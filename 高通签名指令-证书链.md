### OPENSSL指令生成私钥和证书
``` bash
# 生成 Root CA 私钥 (2048-bit RSA)
openssl genrsa -out qpsa_rootca.key 2048

# 生成自签名 Root CA 证书（X.509）
openssl req -new -sha256 -key qpsa_rootca.key -x509 -out rootca_pem.crt \
  -subj "/C=US/ST=California/L=San Diego/OU=General Use Test Key (for testing 13 only)/OU=CDMA Technologies/O=QUALCOMM/CN=QCT Root CA 1" \
  -days 7300 -set_serial 1 -config opensslroot.cfg \
  -sigopt rsa_padding_mode:pss -sigopt rsa_pss_saltlen:-1 -sigopt digest:sha256

# PEM → DER 格式转换
openssl x509 -in rootca_pem.crt -inform PEM -out qpsa_rootca.cer -outform DER

# 查看证书内容
openssl x509 -text -inform DER -in qpsa_rootca.cer



# 生成 Attestation CA 私钥
openssl genrsa -out qpsa_attestca.key 2048

# 生成证书签名请求 (CSR)
openssl req -new -key qpsa_attestca.key -out attestca.csr \
  -subj "/C=US/ST=CA/L=San Diego/OU=CDMA Technologies/O=QUALCOMM/CN=QUALCOMM Attestation CA" \
  -config opensslroot.cfg

# 用 Root CA 签发 Attestation CA 证书
openssl x509 -req -in attestca.csr -CA rootca_pem.crt -CAkey qpsa_rootca.key \
  -out attestca_pem.crt -set_serial 5 -days 7300 -extfile v3.ext \
  -sigopt rsa_padding_mode:pss -sigopt rsa_pss_saltlen:-1 -sigopt digest:sha256

# 格式转换（PEM → DER）
openssl x509 -inform PEM -in attestca_pem.crt -outform DER -out qpsa_attestca.cer

openssl dgst -sha384 qpsa_rootca.cer > sha384rootcert.txt
```
### 私钥中提取公钥
``` bash
# 从 PEM 格式证书提取公钥
openssl x509 -in rootca_pem.crt -noout -pubkey > rootca_pub.pem
# 从 DER 格式证书提取公钥
openssl x509 -inform DER -in qpsa_rootca.cer -noout -pubkey > rootca_pub.pem
# 验证公钥内容
openssl rsa -in rootca_pub.pem -pubin -text -noout
```
### 高通的签名配置
``` xml
    <general_properties>
        <!--签名和加密器选择-->
        <selected_signer>local_v2</selected_signer>
        <selected_encryptor>unified_encryption_2_0</selected_encryptor>
        <selected_cert_config>OEM-KEYS</selected_cert_config>
        <cass_capability>secboot_sha2_pss_subca2</cass_capability>
		
        <!--RSA 密钥参数-->
        <key_size>2048</key_size>
        <exponent>65537</exponent>
		
        <!--证书和根证书-->
        <mrc_index>0</mrc_index>
        <num_root_certs>1</num_root_certs>
        <!--支持的最大根证书数量-->
        <max_num_root_certs>4</max_num_root_certs>
        <root_revoke_activate_enable>disable</root_revoke_activate_enable>
        <!--
          JTAG ID:
          0x001B80E1 - divar
          0x002390E1 - IoT
          -->
        <!--平台和芯片信息-->
        <msm_part>0x001B80E1</msm_part>
        <soc_vers>0x9007</soc_vers>
        <in_use_soc_hw_version>enable</in_use_soc_hw_version>
        <oem_id_independent>disable</oem_id_independent>
        <oem_id>0x02AA</oem_id>
        <model_id>0x1102</model_id>
        <!--调试与序列号-->
        <debug>nop</debug>
        <multi_serial_numbers>
            <!--<serial>0x12345678</serial>-->
        </multi_serial_numbers>
		
        <!--SecBoot 与签名设置-->
        <secboot_version>3.0</secboot_version>
        <qti_sign>false</qti_sign>
        <oem_sign>true</oem_sign>
		
        <!--证书链和加密算法-->
        <max_cert_size>2048</max_cert_size>
        <num_certs_in_certchain>3</num_certs_in_certchain>

        <UIE_key>default</UIE_key>
        <uie_key_switch_enable>disable</uie_key_switch_enable>
        <hmac>false</hmac>
        <dsa_type>rsa</dsa_type>
        <rsa_padding>pss</rsa_padding>
        <hash_algorithm>sha256</hash_algorithm>
        <segment_hash_algorithm>sha384</segment_hash_algorithm>
    </general_properties>
```