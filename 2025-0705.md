### 1、签名相关配置
**xml文件配置 **
``project/nonhlos/Divar.LA.3.0.1/common/sectools/config/divar/*.xml``

<span style="color:red">**签名用的key**</span>
`project/nonhlos/Divar.LA.3.0.1/common/sectools/resources/data_prov_assets/Signing/Local/OEM-KEYS`

**代码相关配置**

* 关闭 VIP 验证机制
* 刷机描述文件添加 `sec.elf`镜像
* 添加sec-boot标志位

### 2、签名打包流程
**项目构建脚本：**

``` bash
function build_all(){
  build_subsystem
  build_system
  build_sign_firmware  #签名固件
  build_vendor
  build_merge
  build_sign_mcfg  #签名modem
  build_sign_all  #签名有分区的镜像
  build_nonhlos
  #build_sign_multi #未启用 该签名

  package_imgs
  build_ota
  package_symbols
}
```
**签名脚本：**

```bash
function main() {
  case "$CUSTOM_SEC_ITEM" in
    all) sign_all_image ;;
    firmware) sign_firmware_images ;;
    multi_image) resign_multi_image ;;
    mcfg) sign_modem_mcfg imges ;;
    *) exit 1; ;;
  esac
}
```

### 3、签名镜像单独开辟分区

* smplap64.mbn 
* smplap32.mbn 

* prog_firehose_lite.elf
* prog_firehose_ddr.elf
* xbl_config.elf
* xbl.elf
* uefi_sec.mbn
* tz.mbn
* storsec.mbn
* sec.elf
* rpm.mbn
* qupv3fw.elf
* keymint.mbn
* imagefv.elf
* hyp.mbn
* devcfg.mbn
* abl.elf

* NON-HLOS.bin

### 4、NON-HLOS.bin 构建
NON-HLOS.bin包含 modem、ta等签名镜像；对这些签名后放回源路径，再构建NON-HLOS.bin镜像
* mcfg_hw.mbn
* mcfg_sw.mbn
* qdsp6sw.mbn
* TA
> 存在mcfg_sw.mbn量很大，出货地区运营商配置，现在存在漏签，出现有的运营商不能打电话情况，建议遍历目录下全部的mcfg_sw.mbn，全部签名

### 5、vendor部分构建
一些firmware固件 打包进 vendor部分，对固件签名后放回原路径，再构建vendor镜像
patch:
`project/vendor/qcom/proprietary/data/ipa_fws/`
`project/vendor/qcom/proprietary/graphics/s-bins/firmware/`
`project/vendor/qcom/proprietary/vfw-vpu-20/`





